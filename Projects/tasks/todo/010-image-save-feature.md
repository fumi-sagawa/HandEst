# タスク名: 画像保存機能の実装

## 概要
現在表示されている3Dビューを画像として保存し、カメラロールに保存する機能を実装する。UIを除外したクリーンな画像を生成する。

## 背景・目的
- 作成した手のポーズを資料として保存
- SNSやポートフォリオでの共有を可能に
- 創作活動での実用性向上

## 優先度
**Medium** - ユーザビリティを大幅に向上させる機能

## 前提条件
- #005（簡易3Dモデル表示）が完了していること
- 他の機能と独立して実装可能

## To-Be（完了条件）
- [ ] 保存ボタンのUI実装（右下配置）
- [ ] 3Dビューのキャプチャ処理
- [ ] UI要素の除外処理
- [ ] 画像の生成（JPEG品質90%）
- [ ] フォトライブラリへの保存権限管理
- [ ] 保存成功/失敗のフィードバック
- [ ] 初回権限リクエストの適切な処理
- [ ] 権限拒否時のエラーハンドリング
- [ ] 保存失敗時のエラー処理（容量不足等）
- [ ] エラーログの記録（Logger使用）
- [ ] 保存機能のテスト
- [ ] エラーケースのテスト作成
- [ ] 実機での保存動作確認
- [ ] テストが全て通る
- [ ] ドキュメント更新完了

## 実装方針
1. UI実装
   - 右下にダウンロードボタン（SF Symbols: square.and.arrow.down）
   - 44x44pt以上のタップ領域
   - 保存中は進行状況表示
2. キャプチャ処理
   - RealityKitのsnapshot機能使用
   - デバイスの画面解像度でキャプチャ
   - UIレイヤーを除外した画像生成
3. 権限管理
   - PHPhotoLibraryの権限リクエスト
   - Info.plistへの説明追加
     - NSPhotoLibraryAddUsageDescription（日本語/英語）
   - 権限拒否時の適切なガイダンス
4. 保存処理
   - PHPhotoLibraryでの非同期保存
   - エラーハンドリング（容量不足等）
   - 保存完了までの状態管理
5. フィードバック
   - 成功時: 触覚フィードバック（success）+ チェックマーク表示
   - エラー時: アラート表示 + エラー内容の説明
   - 保存中: プログレスインジケーター

## 関連情報
- 前提タスク: #005（簡易3Dモデル表示）
- 機能要件仕様書: 4.7 画像保存機能
- Photos framework公式ドキュメント

## 作業ログ
### YYYY-MM-DD HH:MM
- 作業内容の記録
- 発生した問題と解決方法
- 次回の作業予定