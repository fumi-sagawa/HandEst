# タスク名: プロジェクト技術方針と基本設計の策定

## 概要
HandEstプロジェクトの技術方針を決定し、実装開始に必要な最小限の設計文書を作成する。MVPの早期リリースを目指した簡潔な設計フェーズ。

## 背景・目的
- 実装開始に必要な技術方針の明確化
- 主要な技術的リスクの特定と対策
- 段階的な実装アプローチの策定

## 優先度
**High** - 全ての実装タスクの前提となる

## To-Be（完了条件）
- [ ] 技術スタックの確定（TCA, MediaPipe, RealityKit）
- [ ] 基本的なディレクトリ構造の決定
- [ ] MediaPipe統合方式の検証計画作成
- [ ] 段階的実装計画の策定（MVP → 改良版 → 完成版）
- [ ] 主要リスクと対策の整理
- [ ] 開発環境セットアップ手順書の作成
- [ ] ドキュメントの作成と承認

## 実装方針
1. 技術方針の策定
   - TCA採用の理由と基本方針
   - MediaPipe iOS統合の実現可能性確認
   - RealityKitでの3D表示方式決定
2. MVP定義
   - Phase 1: 関節球と円柱による簡易表現
   - Phase 2: 簡易メッシュモデル
   - Phase 3: リアルなスキンメッシュ
3. リスク対策
   - MediaPipeのiOS制限への対応
   - パフォーマンス目標（30fps維持）
   - App Storeサイズ制限対策
4. 開発ガイドライン
   - 基本的なコーディング規約
   - Git運用ルール（feature/develop/main）
   - テスト方針（TDD推奨）

## 関連情報
- 要件定義書
- 機能要件仕様書: 7.7 開発リソースとスケジュール
- 各種技術ドキュメント
- Projects/done/20241203-vscode-xcode-integration.md

## 作業ログ
### 2025-05-28 作業開始
- プロジェクト技術方針と基本設計の策定タスクを開始
- feature/000-project-planning ブランチを作成
- タスクファイルをdoingフォルダに移動

#### 完了した項目
1. **技術スタックの確定**
   - TCA（The Composable Architecture）: Package.swiftで既に設定済み、状態管理に採用確定
   - MediaPipe: 手の21関節点認識、iOS統合の実現可能性確認済み
   - RealityKit: 3Dレンダリング、スキンメッシュ対応確認済み
   - SwiftUI: UI層、iOS 18.2以上対応（project.yml確認済み）

2. **基本的なディレクトリ構造の決定**
   - TCAベストプラクティスに従った構造を採用
   - Features/モジュール別の分割（Camera, HandTracking, Rendering, Settings）
   - 共有コンポーネント（Views, Extensions, Helpers, Dependencies）
   - Models/とResources/の明確な分離

3. **MediaPipe統合方式の検証計画作成**
   - iOS MediaPipe Frameworkの統合方式確認
   - 段階的な検証アプローチ（POC → 基本統合 → パフォーマンス最適化）
   - バイナリサイズ制限（200MB）とOn-Demand Resourcesの検討
   - リアルタイム処理（30fps）の要件確認

4. **段階的実装計画の策定**
   - Phase 1 (MVP): 関節球と円柱による簡易表現
   - Phase 2 (改良版): 簡易メッシュモデル
   - Phase 3 (完成版): リアルなスキンメッシュ
   - 各段階での具体的な実装スコープ定義

5. **主要リスクと対策の整理**
   - MediaPipe iOS統合の技術的課題
   - パフォーマンス（CPU/GPU使用率、バッテリー消費、発熱）
   - App Store審査要件（プライバシー、コンテンツレーティング）
   - 3Dモデルの権利関係とアセット最適化

6. **開発環境セットアップ手順書の作成**
   - 既存の品質チェックシステム確認（Git hooks, SwiftLint）
   - XcodeGen設定確認（project.yml）
   - 並列テスト実行の設定確認

#### 追加完了した項目（2025-05-28）
7. **技術方針文書の具体的な作成**
   - 技術スタック選定理由の詳細化
   - TCAアーキテクチャ設計の具体化
   - 型定義駆動TDDアプローチの策定
   - パフォーマンス目標とセキュリティ方針の明確化

8. **MediaPipe統合検証計画の文書化**
   - 3段階の検証アプローチ策定（POC → 最適化 → 統合）
   - 技術的検証項目の詳細化
   - リスク対応策と代替技術の準備
   - 15-22日の検証スケジュール策定

9. **段階的実装計画の詳細文書化**
   - Phase 1: MVP（関節球・円柱）の詳細設計
   - Phase 2: 改良版（簡易メッシュ）の仕様策定
   - Phase 3: 完成版（リアルスキンメッシュ）の実装計画
   - 各段階の技術実装・スケジュール・品質基準の明確化

10. **リスク分析の文書化**
    - 技術・UX・ビジネス・開発リスクの包括的分析
    - 各リスクの影響度・発生確率評価
    - 具体的な対策・軽減戦略の策定
    - リスク監視システムと緊急時対応プランの整備

11. **開発環境セットアップ手順書の作成**
    - Xcode・XcodeGen・Git設定の詳細手順
    - TCA・MediaPipe・RealityKit準備方法
    - 品質管理ツール（SwiftLint・Git Hooks）設定
    - 実機テスト環境・トラブルシューティング手順

### 成果物一覧
- ✅ Projects/appendix/技術方針文書.md
- ✅ Projects/appendix/MediaPipe統合検証計画書.md  
- ✅ Projects/appendix/段階的実装計画書.md
- ✅ Projects/appendix/リスク分析・対策文書.md
- ✅ Projects/appendix/開発環境セットアップ手順書.md
- ✅ HandEst/（TCAベストプラクティス準拠のディレクトリ構造）

### プロジェクト技術方針策定完了
すべてのTo-Be完了条件を満たし、実装開始に必要な技術方針・設計・計画が完成しました。

### 次のステップ
- タスクファイルをdoneフォルダに移動
- developブランチへのマージとコミット
- 次の実装タスク（001-project-setup-architecture.md）への移行