# タスク名: カメラアクセスと権限管理機能の実装

## 概要
AVFoundationを使用したカメラアクセス機能と、iOS標準のカメラ権限リクエスト・管理機能を実装する。TCAのDependencyとして実装し、テスタブルな設計にする。

## 背景・目的
- ユーザーの手を認識するためのカメラ映像取得
- 適切な権限管理によるプライバシー保護
- エラーハンドリングの基盤構築

## 優先度
**High** - MediaPipe手認識の前提となる基本機能

## 前提条件
- #002（TCA状態管理）が完了していること

## To-Be（完了条件）
- [ ] CameraClientの依存関係を定義
- [ ] AVCaptureSessionの初期化と管理
- [ ] カメラ権限のリクエストと状態管理
- [ ] CameraFeatureのReducer実装
- [ ] カメラプレビューの表示（SwiftUI）
- [ ] 権限拒否時のエラーハンドリング
- [ ] カメラ初期化エラーの処理（Logger使用）
- [ ] エラーメッセージの基本実装（AppError使用）
- [ ] バックグラウンド時の自動停止
- [ ] CameraFeatureの単体テスト作成
- [ ] エラーケースのテスト作成
- [ ] 実機での動作確認（権限ダイアログ、プレビュー表示）
- [ ] テストが全て通る
- [ ] ドキュメント更新完了

## 実装方針
1. CameraClient依存関係の定義
   - 権限チェック（async/await）
   - セッション開始/停止
   - フレーム取得のデリゲート
   - デバイス切り替え（前面/背面）
2. CameraFeatureの実装
   - State: 権限状態、カメラ状態、エラー、現在のデバイス
   - Action: 権限リクエスト、開始/停止、デバイス切替
   - Effect: 権限要求、セッション制御
3. SwiftUIでのプレビュー表示
   - AVCaptureVideoPreviewLayerのUIViewRepresentable化
   - 適切なContentModeの設定
   - 回転対応
4. Info.plistへの権限説明追加
   - NSCameraUsageDescription
   - 日本語と英語の説明文

## 関連情報
- 前提タスク: #002（TCA状態管理）
- AVFoundation公式ドキュメント
- 要件定義書: 5.4 セキュリティ・プライバシー要件
- 機能要件仕様書: 4.1 アプリケーション起動時の動作

## 作業ログ
### YYYY-MM-DD HH:MM
- 作業内容の記録
- 発生した問題と解決方法
- 次回の作業予定