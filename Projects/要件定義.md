# Hand Estimator アプリケーション要件定義書

## 1. 背景と目的

### 1.1 背景

イラストレーターや漫画家、アニメーターにとって、手の描画は最も難しい課題の一つです。現在、以下の問題に直面しています：

- **パースペクティブの固定性**: 既存の写真資料や3Dモデルアプリでは、撮影時の焦点距離に固定されており、広角から望遠まで自由にパースペクティブを変更できない
- **立体構造の把握困難**: 2D写真では手の複雑な立体構造や奥行きを理解することが難しい
- **リアルタイム性の欠如**: 自分の手を見ながら描くと、描きたい角度を維持できず、既存の3Dツールは操作が煩雑

### 1.2 目的

本アプリケーションは、上記の課題を解決し、以下を実現することを目的とします：

1. **即座に利用可能な3D手資料の提供**: カメラに手をかざすだけで、リアルタイムに3Dモデル化
2. **自由なパースペクティブ変更**: 焦点距離を自由に切り替え、様々な画角での手の見え方を確認可能
3. **直感的な操作体験**: シンプルで分かりやすい操作により、創作活動に集中できる環境の提供

---

## 2. アプリケーション概要

### 2.1 基本情報

- **アプリケーション名**: Hand Estimator (Hand Est.)
- **プラットフォーム**: iOS（iPhone/iPad）
- **アプリケーションタイプ**: ネイティブiOSアプリケーション

### 2.2 コンセプト

デバイスのカメラを使用してユーザーの手をリアルタイムで認識し、3Dモデルとして表示。焦点距離の変更や特殊効果の適用により、様々なパースペクティブで手を観察できるツール。

---

## 3. 対象ユーザー

### 3.1 プライマリーユーザー

- **プロフェッショナルイラストレーター**: 正確な手の描画が必要な商業作品を制作
- **漫画家**: 締め切りに追われながら、効率的に手を描く必要がある
- **アニメーター**: 動きの中での手の形状変化を研究する必要がある

### 3.2 セカンダリーユーザー

- 美術学生
- 趣味のイラストレーター
- 3DCGアーティスト

---

## 4. 機能要件

### 4.1 手の認識と3D表示機能

#### 4.1.1 リアルタイム手認識

- デバイスのカメラを使用して、ユーザーの手をリアルタイムで認識
- 21個の関節点を検出し、手の形状を正確に把握
- 認識した手の情報を基に3Dモデルを生成・表示

#### 4.1.2 表示レイヤー構造

- **背景層**: カメラ映像をグレースケール変換し、ガウシアンブラーを適用
- **前景層**: 認識した手の3Dモデルをリアルタイムでレンダリング
- **UI層**: 操作コントロールを半透明で配置

### 4.2 ポーズロック機能

- 現在認識している手のポーズを固定（ロック）
- ロック時はカメラプレビューを非表示にし、3Dモデルのみを表示
- ロック解除により、再度リアルタイム認識モードに移行

### 4.3 3Dモデル操作機能

#### 4.3.1 回転操作

- 1本指の横スワイプでY軸回転（水平回転）
- 1本指の縦スワイプでX軸回転（垂直回転）
- 回転はモデルの重心を中心に実行

#### 4.3.2 拡大縮小操作

- 2本指のピンチジェスチャーで拡大・縮小
- 拡大率は0.5倍から3.0倍の範囲で調整可能

### 4.4 焦点距離変更機能

#### 4.4.1 選択可能な焦点距離
- F.E.: 魚眼レンズほどの大きな視野角
- **24mm（広角）**: 視野角84°、パースペクティブが強調される表現
- **50mm（標準）**: 視野角46°、自然な見え方
- **85mm（望遠）**: 視野角28°、パースペクティブが圧縮された表現
- P.P.: 無限遠点での透視投影
#### 4.4.2 動作仕様

- すべての状態（認識中、ロック中、操作中）で焦点距離の変更が可能
- 選択と同時にパースペクティブがリアルタイムで変化
- 自動サイズ調整により、焦点距離を変更しても手のモデルが画面内で一定のサイズを維持

### 4.5 画像保存機能

- 現在表示されている3Dビューを画像として保存
- カメラロールへの保存をサポート

---

## 5. 非機能要件

### 5.1 性能要件

- **認識精度**: 良好な照明条件下で95%以上の手認識成功率
- **フレームレート**: 30fps以上でのリアルタイム表示
- **応答性**: ユーザー操作に対して100ms以下の遅延で反応

### 5.2 使用性要件

- 初回起動時の簡潔なチュートリアル
- 直感的で学習コストの低いユーザーインターフェース
- 片手での操作が可能な設計

### 5.3 互換性要件

- **対応OS**: iOS 15.0以上
- **対応デバイス**: iPhone X以降、iPad（第6世代）以降
- **画面サイズ**: 4.7インチから12.9インチまでの各種画面サイズに対応

### 5.4 セキュリティ・プライバシー要件

- カメラ使用許可の適切な要求と説明
- 撮影した映像データの非保存（リアルタイム処理のみ）
- ユーザーの手の画像や認識データをサーバーに送信しない

---

## 6. ユーザーインターフェース要件

### 6.1 画面構成

#### 6.1.1 メイン画面レイアウト

- 上部：アプリ名とヘルプボタン
- 中央：カメラプレビューまたは3Dモデル表示エリア
- 下部：焦点距離選択ボタンと特殊効果ボタン
- 中央下部：ロックボタン（カメラアイコン）

#### 6.1.2 操作フィードバック

- ロック状態の明確な視覚的表示
- 焦点距離変更時のスムーズなアニメーション
- ジェスチャー操作時の視覚的ガイド表示

### 6.2 エラー処理

- 手が認識できない場合の適切なメッセージ表示
- カメラ権限が許可されていない場合の案内
- 低照度環境での警告表示

---

## 7. 制約事項
### 7.1 技術的制約
- リアルタイム処理のため、デバイスの処理能力に依存
- カメラの性能により認識精度が左右される
- 暗い環境や手袋着用時は認識精度が低下する可能性

### 7.2 運用上の制約
- インターネット接続は不要（オフライン動作）
- 初期バージョンでは単一の手のみ認識
- 手のモデルタイプは固定（カスタマイズ不可）
